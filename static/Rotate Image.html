<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Rotate Image — iLoveIMG Clone (Full)</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root{--bg:#f8fafc;--card:#fff;--accent:#3498db;--muted:#6b7280}
    *{box-sizing:border-box}
    body{font-family:Inter,system-ui,-apple-system,'Segoe UI',Roboto,Helvetica,Arial; background:var(--bg); margin:0; color:#0f172a}
    .wrap{max-width:980px;margin:36px auto;padding:20px}
    .header{display:flex;justify-content:space-between;align-items:center;margin-bottom:18px}
    .logo{display:flex;gap:12px;align-items:center}
    .logo img{height:36px}
    h1{font-size:20px;margin:0}
    p.lead{color:var(--muted);margin:6px 0 0}
    .card{background:var(--card);border-radius:12px;padding:20px;box-shadow:0 6px 20px rgba(2,6,23,0.06)}
    .upload-box{border:2px dashed rgba(15,23,42,0.08);border-radius:10px;padding:28px;display:flex;gap:20px;align-items:center;justify-content:center;flex-direction:column;cursor:pointer}
    .upload-box.highlight{background:linear-gradient(90deg,rgba(52,152,219,0.06),rgba(231,76,60,0.03));border-color:var(--accent)}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:8px;border:none;cursor:pointer;font-weight:600;transition:0.2s}
    .btn:hover{opacity:0.9}
    .btn-primary{background:var(--accent);color:#fff}
    .btn-secondary{background:#111827;color:#fff}
    .muted{color:var(--muted)}
    .grid{display:grid;grid-template-columns:1fr 360px;gap:18px;margin-top:18px}
    .panel{display:flex;flex-direction:column;gap:12px}
    .preview{display:flex;flex-direction:column;gap:8px;align-items:center}
    canvas{max-width:100%;max-height:360px;border-radius:8px;object-fit:contain;background:#f3f4f6;padding:8px}
    .small{font-size:13px;color:var(--muted)}
    footer{margin-top:20px;text-align:center;color:var(--muted);font-size:13px}
    @media (max-width:900px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="header">
      <div class="logo">
        <img src="iloveimg-logo.svg" alt="logo">
        <div>
          <h1>Rotate Image</h1>
          <p class="lead">Rotate and Download with transparent background — iLoveIMG Clone</p>
        </div>
      </div>
      <div class="actions">
        <a class="btn btn-secondary" href="index.html"><i class="fa fa-arrow-left"></i> Back</a>
      </div>
    </div>

    <div class="card">
      <div class="upload-box" id="uploadBox">
        <div style="text-align:center">
          <i class="fa fa-cloud-upload" style="font-size:36px;color:var(--accent)"></i>
          <h3 style="margin:8px 0 6px">Drag & drop or select an image</h3>
          <p class="small muted">JPG, PNG, WebP — max 25MB (demo)</p>
        </div>
        <div>
          <button id="selectBtn" class="btn btn-primary"><i class="fa fa-folder-open"></i> Select Image</button>
          <input id="fileInput" type="file" accept="image/*" style="display:none">
        </div>
      </div>

      <div class="grid" style="margin-top:18px">
        <div class="panel">
          <div class="card preview" id="previewArea">
            <canvas id="canvas"></canvas>
            <div id="placeholder" style="padding:26px;text-align:center;color:var(--muted)">Preview will appear here</div>
          </div>

          <div class="card">
            <div style="display:flex;justify-content:center;gap:10px;margin-bottom:10px">
              <button id="leftBtn" class="btn"><i class="fa fa-undo"></i> Rotate Left</button>
              <button id="rightBtn" class="btn"><i class="fa fa-redo"></i> Rotate Right</button>
            </div>

            <label>Rotate Angle (degrees)</label>
            <input id="angle" type="range" min="0" max="360" step="1" value="0">
            <p style="text-align:center" class="small">Angle: <span id="angleVal">0°</span></p>
            <div style="display:flex;gap:10px;margin-top:10px;justify-content:center">
              <button id="resetBtn" class="btn">Reset</button>
              <button id="downloadBtn" class="btn btn-secondary" style="display:none"><i class="fa fa-download"></i> Download PNG</button>
            </div>
          </div>
        </div>

        <aside class="card panel">
          <strong>Status</strong>
          <p id="status" class="small muted">No file loaded</p>
        </aside>
      </div>
    </div>

    <footer>
      <p>&copy; 2025 iLoveIMG Clone — Rotate Tool (Full Version)</p>
    </footer>
  </div>

  <script>
    const uploadBox = document.getElementById('uploadBox');
    const fileInput = document.getElementById('fileInput');
    const selectBtn = document.getElementById('selectBtn');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const placeholder = document.getElementById('placeholder');
    const angle = document.getElementById('angle');
    const angleVal = document.getElementById('angleVal');
    const resetBtn = document.getElementById('resetBtn');
    const leftBtn = document.getElementById('leftBtn');
    const rightBtn = document.getElementById('rightBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const status = document.getElementById('status');

    let img = new Image();
    let original = null;
    let currentAngle = 0;

    selectBtn.addEventListener('click',()=>fileInput.click());
    fileInput.addEventListener('change',e=>handleFile(e.target.files[0]));

    ['dragenter','dragover'].forEach(evt=>uploadBox.addEventListener(evt,e=>{e.preventDefault();uploadBox.classList.add('highlight');}));
    ['dragleave','drop'].forEach(evt=>uploadBox.addEventListener(evt,e=>{e.preventDefault();uploadBox.classList.remove('highlight');}));
    uploadBox.addEventListener('drop', e=>handleFile(e.dataTransfer.files[0]));

    angle.addEventListener('input',()=>{
      currentAngle = parseInt(angle.value);
      angleVal.textContent = currentAngle + '°';
      if(img.src) drawRotated();
    });

    leftBtn.addEventListener('click',()=>{currentAngle=(currentAngle-90+360)%360;updateRotation();});
    rightBtn.addEventListener('click',()=>{currentAngle=(currentAngle+90)%360;updateRotation();});

    resetBtn.addEventListener('click',()=>{
      fileInput.value = '';
      img.src = '';
      placeholder.style.display='block';
      canvas.style.display='none';
      angle.value=0;
      angleVal.textContent='0°';
      currentAngle=0;
      downloadBtn.style.display='none';
      status.textContent = 'No file loaded';
    });

    downloadBtn.addEventListener('click',()=>{
      const link = document.createElement('a');
      link.download = 'rotated.png';
      link.href = canvas.toDataURL('image/png'); // transparent PNG download
      link.click();
    });

    function updateRotation(){
      angle.value=currentAngle;
      angleVal.textContent=currentAngle+'°';
      drawRotated();
    }

    function handleFile(file){
      if(!file || !file.type.startsWith('image/')) return alert('Please select a valid image');
      const reader = new FileReader();
      reader.onload = e=>{
        img.onload = ()=>{
          original = {w: img.width, h: img.height};
          placeholder.style.display='none';
          canvas.style.display='block';
          drawRotated();
          status.textContent = 'Image loaded';
          downloadBtn.style.display='inline-flex';
        };
        img.src = e.target.result;
      };
      reader.readAsDataURL(file);
    }

    function drawRotated(){
      const radians = currentAngle * Math.PI / 180;
      const sin = Math.abs(Math.sin(radians));
      const cos = Math.abs(Math.cos(radians));
      const newW = original.w * cos + original.h * sin;
      const newH = original.w * sin + original.h * cos;
      canvas.width = newW;
      canvas.height = newH;
      ctx.clearRect(0,0,newW,newH);
      ctx.save();
      ctx.translate(newW/2,newH/2);
      ctx.rotate(radians);
      ctx.drawImage(img,-original.w/2,-original.h/2);
      ctx.restore();
    }
  </script>
</body>
</html>
